var htmel=function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(exports,e,t){n.o(exports,e)||Object.defineProperty(exports,e,{enumerable:!0,get:t})},n.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const o="Text/CSS node",i="Attribute value",r="Attribute name",s="HTML tag";function a(e,t){const n=[{type:o,xpath:`.//text()[contains(., '${t}')]`},{type:i,xpath:`.//@*[contains(., '${t}')]`},{type:r,xpath:`.//@*[contains(name(), '${t}')]`},{type:s,xpath:`.//*[contains(name(), '${t}')]`}];for(let t of n){let n=document.evaluate(t.xpath,e,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue;if(null!=n)return{domNode:n,searchLocation:t.type}}}class l{constructor(e,t,n){this.expressions=e,this.domNode=t,this.bindingLocation=n,this.initialValue={[o]:()=>t.data,[i]:()=>t.value}[n]()}update(){this.bindingLocation===o?this.updateTextNodeValue():this.updateAttributeNodeValue()}updateTextNodeValue(){let e=this.expressions[0].lastResult;if(this._lastTextNodeValue instanceof Array){for(let e of this._arrayDomNodes)e.remove();this._arrayDomNodes=[]}if(e instanceof Array){this._arrayDomNodes=e.map(e=>"object"==typeof e?e:document.createTextNode(e));let t=document.createElement("htmel-list-container");this.domNode.replaceWith(t),this.domNode=t;for(let e of this._arrayDomNodes)this.domNode.appendChild(e)}else if("object"==typeof e)this.domNode.replaceWith(e),this.domNode=e;else if("object"==typeof this._lastTextNodeValue){let t=document.createTextNode(e);this.domNode.replaceWith(t),this.domNode=t}else this.domNode.data=e;this._lastTextNodeValue=e}updateAttributeNodeValue(){if(this.bindingLocation===i&&this.expressions[0].isEventHandler){if(this.expressions.length>1){throw`HTMEL: Cant have more than one expression as event handler: ${c(this.initialValue,this.expressions)}`}this._setEventListener()}else{let e=this.initialValue;for(let t of this.expressions)e=e.replace(t.id,t.lastResult);this.domNode.value=e}}_setEventListener(){let e=this.domNode.name.substring(2);this.domNode.ownerElement.addEventListener(e,(...e)=>{const t=this.expressions[0].lastResult(...e);return"function"==typeof t?t(...e):t}),this.domNode.ownerElement.removeAttributeNode(this.domNode)}}class d{constructor(e){this._cb=e,this.id=new Array(4).fill(0).map(()=>Math.random().toString(36).substr(2,9)).join("-"),this.lastResult=null,this.boundNode=null,this.isEventHandler=!1,this.isStatic="function"!=typeof this._cb}execute(){this.isEventHandler||this.isStatic?this.lastResult=this._cb:this.lastResult=this._cb()}}function u(e,t){let n=e.data,o=e.data.indexOf(t),i=o+t.length;return 0!==o&&e.parentNode.insertBefore(document.createTextNode(n.substring(0,o)),e),i<n.length&&e.parentNode.insertBefore(document.createTextNode(n.substring(i)),e.nextSibling),e.data=n.substring(o,i),e}function c(e,t){for(let n of t)e=e.replace(n.id,"${"+n._cb.toString()+"}");return e}t.default=function(e={},t=60){return(n,...f)=>{const h=f.map(e=>new d(e)),p=function(e){const t=document.createElement("template");if(t.innerHTML=e,t.content.children.length>1);else if(0===t.content.children.length)throw"HTMEL: Component can't be empty";return t.content.firstElementChild}((m=n,h.map(e=>e.id).reduce((e,t,n)=>e+t+m[n+1],m[0])));var m;!function(e,t){const n=new Map;for(let d of t){let t=a(e,d.id);if(null==t)throw`HTMEL: Expression location is not valid: ${"${"+d._cb.toString()+"}"}`;let{domNode:f,searchLocation:h}=t;if(h===o&&(f=u(f,d.id)),h===s){throw`HTMEL: Calculating element name is not allowed: ${c(`<${f.localName}>`,[d])}`}if(h===r){throw`HTMEL: Calculating attribute name is not allowed: ${c(f.localName,[d])}`}if(h===i&&f.name.startsWith("on")&&(d.isEventHandler=!0),n.has(f)){let e=n.get(f);e.expressions.push(d),d.boundNode=e}else{let e=new l([d],f,h);n.set(f,e),d.boundNode=e}}}(p,h);let b=!1,N=new Set,y=new Set;"object"==typeof e&&function(e,t,n){const o={},i=i=>{Object.defineProperty(e,i,{get:()=>(t&&t(i),o[i]),set(e){o[i]=e,n&&n(i,e)}})},r=Object.getOwnPropertyDescriptors(e);for(let t of Object.keys(r))o[t]=e[t],i(t);Object.setPrototypeOf(e,new Proxy(o,{get(t,n){i(n),Reflect.get(e,n)},set:(t,n,o)=>(i(n),e[n]=o,!0)}))}(e,e=>b&&y.add(e),(e,t)=>{N.add(e),g()});let x=new Map;const g=function(e,t){let n,o,i,r=null,s=0,a=function(){s=Date.now(),r=null,i=e.apply(n,o),r||(n=o=null)};return function(){let l=Date.now(),d=t-(l-s);return n=this,o=arguments,d<=0||d>t?(r&&(clearTimeout(r),r=null),s=l,i=e.apply(n,o),r||(n=o=null)):r||(r=setTimeout(a,d)),i}}(()=>{let e=new Set;for(let t of N){let n=x.get(t);n&&n.forEach(t=>e.add(t))}N.clear(),v([...e])},1e3/t),v=e=>{for(let t of e)b=!0,t.execute(),b=!1,y.forEach(e=>{x.has(e)||x.set(e,new Set),x.get(e).add(t)}),y.clear();for(let t of new Set(e.map(e=>e.boundNode)))t.update()};return v(h),p}}}]);export default htmel.default
